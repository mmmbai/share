æ˜ç™½äº† ğŸ‘ æˆ‘å¸®ä½ å†™ä¸€ä¸ª åå°é™é»˜è¿è¡Œ çš„ç‰ˆæœ¬ï¼Œè¿™æ ·è„šæœ¬å¯åŠ¨åä¼šåœ¨åå°è¿è¡Œï¼Œä¸ä¼šä¸€ç›´å ç€ä¸€ä¸ª PowerShell çª—å£ã€‚

ğŸ”¹ æ–¹æ¡ˆä¸€ï¼šç”¨ VBS å¯åŠ¨ PowerShellï¼ˆæ¨èï¼‰

æˆ‘ä»¬ç”¨ä¸€ä¸ª .vbs æ–‡ä»¶æ¥éšè—è¿è¡Œ PowerShell è„šæœ¬ã€‚

1. PowerShell è„šæœ¬ï¼ˆä¿æŒçŠ¶æ€ï¼‰

ä¿å­˜ä¸º keep-teams-awake-hidden.ps1ï¼ˆå°±æ˜¯ä¹‹å‰çš„ Scroll Lock è„šæœ¬ï¼‰ï¼š

Add-Type -TypeDefinition @"
using System;
using System.Runtime.InteropServices;

public class Keyboard {
    [DllImport("user32.dll", SetLastError = true)]
    public static extern void keybd_event(byte bVk, byte bScan, uint dwFlags, UIntPtr dwExtraInfo);
}
"@

$VK_SCROLL = 0x91
$KEYEVENTF_KEYUP = 0x0002

while ($true) {
    [Keyboard]::keybd_event($VK_SCROLL, 0, 0, [UIntPtr]::Zero)
    [Keyboard]::keybd_event($VK_SCROLL, 0, $KEYEVENTF_KEYUP, [UIntPtr]::Zero)

    Start-Sleep -Seconds 300
}

2. VBS å¯åŠ¨å™¨ï¼ˆéšè—çª—å£è¿è¡Œï¼‰

æ–°å»ºä¸€ä¸ª run-hidden.vbs æ–‡ä»¶ï¼Œå†…å®¹å¦‚ä¸‹ï¼š

Set WshShell = CreateObject("WScript.Shell")
WshShell.Run "powershell.exe -ExecutionPolicy Bypass -File ""C:\path\to\keep-teams-awake-hidden.ps1""", 0, False


âš ï¸ æŠŠ C:\path\to\... æ›¿æ¢æˆä½  .ps1 è„šæœ¬çš„çœŸå®è·¯å¾„ã€‚
å‚æ•° 0 è¡¨ç¤ºéšè—çª—å£ï¼ŒFalse è¡¨ç¤ºä¸ç­‰å¾…è„šæœ¬ç»“æŸã€‚

3. ä½¿ç”¨æ–¹æ³•

åŒå‡» run-hidden.vbsï¼ŒPowerShell è„šæœ¬ä¼šåœ¨åå°è¿è¡Œï¼Œæ²¡æœ‰çª—å£ã€‚

å¦‚æœè¦åœæ­¢ï¼Œå¯ä»¥æ‰“å¼€ ä»»åŠ¡ç®¡ç†å™¨ï¼Œæ‰¾åˆ° powershell.exe è¿›ç¨‹ï¼Œç»“æŸå³å¯ã€‚

ğŸ”¹ æ–¹æ¡ˆäºŒï¼šä»»åŠ¡è®¡åˆ’ç¨‹åº (Task Scheduler)

å¦‚æœä½ æƒ³è®©å®ƒ å¼€æœºè‡ªåŠ¨åå°è¿è¡Œï¼Œå¯ä»¥ç”¨ Windows çš„ ä»»åŠ¡è®¡åˆ’ç¨‹åºï¼š

æ‰“å¼€ Task Scheduler â†’ åˆ›å»ºä»»åŠ¡ã€‚

è§¦å‘å™¨é€‰æ‹© ç™»å½•æ—¶ã€‚

åŠ¨ä½œé€‰æ‹© å¯åŠ¨ç¨‹åº â†’ powershell.exeã€‚

å‚æ•°ï¼š

-WindowStyle Hidden -ExecutionPolicy Bypass -File "C:\path\to\keep-teams-awake-hidden.ps1"


ä¿å­˜å³å¯ã€‚

è¿™æ ·æ¯æ¬¡å¼€æœºéƒ½ä¼šè‡ªåŠ¨åœ¨åå°è¿è¡Œï¼Œä¸éœ€è¦ä½ ç‚¹ä»»ä½•ä¸œè¥¿ã€‚
